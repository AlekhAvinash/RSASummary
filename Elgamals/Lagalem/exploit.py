#!/usr/bin/python3
from Crypto.Util.number import *

def exploit():
	from enc import pubkey,c1,c2,c1_,c2_
	g, h, A, B, p, q = pubkey

	hB_ = inverse(pow(h, B, p),p)
	c2__ = inverse(c2, p)
	assert GCD(A-1,p-1)==1
	A_ =inverse(A-1,p-1)
	
	gxr = pow(c2_*hB_*c2__,A_, p)
	m = (c2 * inverse(gxr, p)) % p
	
	print(long_to_bytes(m))

if __name__ == '__main__':
	exploit()